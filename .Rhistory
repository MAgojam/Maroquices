pr=xr/(nR*n)
n=20
nx=nD*n
pc=xc/(nx)
xr=2
nR=2
pr=xr/(nR*n)
ci=0.95
xc=30
nD=18
n=20
nx=nD*n
pc=xc/(nx)
xr=2
nR=2
pr=xr/(nR*n)
xc=15
nD=18
n=20
nx=nD*n
pc=xc/(nx)
xr=1
nR=2
pr=xr/(nR*n)
ci=0.95
p=(xc+xr)/(nD*n+nR*n)
xc=15
nD=18
s=20
nx=nD*n
pc=xc/(nx)
xr=1
nR=2
pr=xr/(nR*n)
alfa=0.05
ci=1-alfa
n=nD*n+nR*n
p=(xc+xr)/(n)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
pacman::p_load(knitr,kableExtra,extrafont,xkcd,tikzDevice,faux,tikzDevice,plyr,tigerstats,EnvStats)
options(scipen=999)
source("DrawProbNorm.R", local = knitr::knit_global())
xc=15
nD=18
s=20
nx=nD*s
pc=round(xc/(nx),3)
xr=1
nR=2
pr=xr/(nR*s)
alfa=0.05
ci=1-alfa
n=nD*s+nR*s
p=(xc+xr)/(n)
LIp=p-qnorm(1-alfa/2)*sqrt(p*(1-p)/n))
qnorm(1-alfa/2)
LIp=p-qnorm(1-alfa/2)|>round(3)*sqrt(p*(1-p)/n)
LIp=round(p-qnorm(1-alfa/2)|>round(3)*sqrt(p*(1-p)/n),3)
LSp=round(p+qnorm(1-alfa/2)|>round(3)*sqrt(p*(1-p)/n),3)
prop.test(x=xc+xr,n=n, p=0.5)
? prop.test
prop.test(x=xc+xr,n=n, p=0.5, correct=F)
prop.test(x=xc+xr,n=n, p=0.5, correct=F)
0.04-1.96*sqrt(0.04*(1-0.04)/400)
z=qnorm(1-alfa/2)|>round(3)
LIpW=1/(1+z^2/n)*(p+z^2/(2*n))-z/(1+z^2/n)*sqrt(p*(1-p)/n+z^2/(4*n^2))
qbeta(alfa/2,xc+xr,n-xc+xr+1)
LSpE <- qbeta(1-alfa/2,xc+xr+1,n-xc+xr)
LIpE <- qbeta(alfa/2,xc+xr,n-xc+xr+1)
binom.test((x=xc+xr,n=n, p=0.5)
binom.test(x=xc+xr,n=n, p=0.5)
ceiling(1.2)
.4*.6*(1.96/0.01)^2
.4*.6/(0.01/1.96)^2
.04*.06/(0.01/1.96)^2
.04*.96/(0.01/1.96)^2
0.04*.96/(0.01/1.96)^2
.04*.96*(1.96/0.01)^2
pacman::p_load(knitr,kableExtra,extrafont,xkcd,tikzDevice,faux,tikzDevice,plyr,tigerstats,EnvStats,PracTools)
nWilson(moe.sw=1,alpha=0.05,pU=p, e=0.01)
pacman::p_load(knitr,kableExtra,extrafont,xkcd,tikzDevice,faux,tikzDevice,plyr,tigerstats,EnvStats,PracTools)
pacman::p_load(knitr,kableExtra,extrafont,xkcd,tikzDevice,faux,tikzDevice,plyr,tigerstats,EnvStats,PracTools)
nWilson(moe.sw=1,alpha=0.05,pU=p, e=0.01)
nWilson(moe.sw=1,alpha=0.05,pU=p, e=e)
e=0.01
nWilson(moe.sw=1,alpha=0.05,pU=p, e=e)
qbinom(0.95,40, 20)
qbinom(0.95,20, 40)
qbinom(0.5,3, 10)
dbinom(3,10,0.5)
dbinom(0,40,0.025)
dbinom(20,40,0.5)
?dbinom
pbinom(20,40,0.5)
pbinom(20,40,0.9)
1-qbinom(0.025,0.39,1/40)
qbeta(0.025, 37, 463)
1-qinom(0.025, 37, 463)
1-qbinom(0.025, 37, 463)
1-qbinom(0.025, 37, 463,37/463)
1-qbinom(0.025, 37, 463,37/463)
1-qbinom(0.025, 463, 37/463)
1-qbinom(0.025, 463, 37/463)/463
qbinom(0.025, 463, 37/463)
qbinom(0.025, 463-1, 36/462)
qbinom(0.025, 463-1, 36/462)/463
pbeta(0.025, 5,10)
pbeta(0.5, 5,10)
1-pbinom(5,10,0.5)
1-pbinom(5-1,10-1,0.5)
pbeta(0.5, 5,10)
1-pbinom(4,9,0.5)
pbinom(4,9,0.5)
pbeta(0.025,1,40-1)
pbeta(0.025,1,40-1+1)
pbeta(0.025,1,40)
pbeta(0.975,2,39)
1-pbinom(0,39,0.025)
1-pbinom(1,39,0.975)
binom.test(1,40,0.5)
binom.test(1,40,0.5)
qbeta(0.025,1,39)
qbeta(0.975,2,39)
1-qbinom(0.025,0,1/40)
qbinom(0.025,0,1/40)
qbinom(0.025,0,1/39)
qbinom(0.975,0,1/39)
qbinom(0.025,0,1/40)
qbinom(0.025,0,0.1)
qbinom(1/40,0,0.025)
qbinom(0.025,40, 1/40)
qbinom(0.025,1, 1/40)
qbinom(0.025,0, 1/40)
qbeta(0.025,34,463)
qbeta(0.025,37,463)
binom.test(x=1, n=40, p=0.5)
qbeta(0.025,xr,nR*s-xr)
xr
nR*x
nR*s
qbeta(0.025,xr,nR*s)
qbeta(0.025,xr,nR*s-xr+1)
qbeta(0.925,xr+1,nR*s-xr)
qbeta(0.975,xr+1,nR*s-xr)
pbeta(0.1,37,463)
1-pbinom(0.1,37-1,500-1)
1-pbinom(37-1,500-1,0.1)
qbeta(.025,37,463)
1-qbinom(.025,36,499)
1-qbinom(.025,36,36/499)
1-qbinom(.975,36,36/499)
1-qbinom(.025,36,36/499)/500
1-qbinom(.025,36,36/499)/499
qbinom(.025,36,36/499)/499
qbinom(.025,36,36/499)
qbeta(0.025,xr,nR*s-xr+1)
1-qbinom(.025,xr-1,(xr-1)/(nR*s-1))
qbinom(.025,xr-1,(xr-1)/(nR*s-1))
qbinom(.25,xr-1,(xr-1)/(nR*s-1))
qbinom(.025,1,1/40)
qbinom(.975,1,1/40)
qbinom(.998,2,0.025)
qbinom(.998,10,0.025)
qbinom(.025,40,1/40)
qbinom(.025,39,1/40)
1-qbinom(0.025,36,36/463)
qbinom(0.025,36,36/463)
qbinom(0.025,36,0.1)
qbinom(0.025,36,0.1)/500
1-qbinom(0.025,36,0.1)/500
1-qbinom(0.025,36,0.1)/463
1-qbinom(0.025,37,0.1)/463
1-qbinom(0.025,37,0.1)/500
1-qbinom(0.025,33,0.1)/499
1-pbinom(36,499,0.1)
qbinom(.025,499,36/499)
qbinom(.025,499,36/499)/500
1-qbinom(.025,499,36/499)/500
qbinom(.025,499,36/500)/500
qbinom(.025,499,37/500)/500
qbinom(0.025,xR-1,xr/40)/40
qbinom(0.025,xr-1,xr/40)/40
qbinom(0.025,xr-1,xr/40)
qbinom(0.925,xr-1,xr/40)
qbinom(0.975,xr-1,xr/40)
qbinom(0.975,40-1,xr/40)
qbinom(0.975,40-1,xr/40)/40
#Exato
binom.test(x=1, n=40, p=0.5)
binom.test(x=1, n=40, p=0.5)
qbinom(0.025,40-1,xr/40)/40
qbinom(0.975,40-1,xr/40)/40
1-qbinom(0.975,40-1,xr/40)/40
qbinom(0.975,40,xr/40)/40
qbinom(0.975,40,0)/40
qbinom(0.975,40,1/39)/40
prop.test(x=r,n=nR*s, p=0.5, correct=F)
prop.test(x=xr,n=nR*s, p=0.5, correct=F)
#Exato
binom.test(x=1, n=40, p=0.5)
s=15
#Exato
binom.test(x=1, n=40, p=0.5)
#Exato
binom.test(x=xr, n=nR*s, p=0.5)
pbeta(0.1,5,5)
pbeta(0.5,5,5)
pbeta(0.2,5,5)
1-pbinom(4,9,0.2)
qbeta(0.25, 5,5)
qbinom(0.25, 5,5)
qbinom(0.25, 5,5/10)
xc=12
nD=18
s=10
nx=nD*s
pc=round(xc/nx,3)
xr=1
nR=2
nr=nR*s
pr=round(xr/(nR*s),3)
alfa=0.05
ci=1-alfa
n=nD*s+nR*s
p=round((xc+xr)/(n),3)
e=0.01
z=qnorm(1-alfa/2)|>round(3)
ci.low.r=(2*nr+z^2 - z*sqrt(z^2+4*nr*(1-*pr))/(2*(nr+z^2))
ci.low.r=(2*nr+z^2 - z*sqrt(z^2+4*nr*(1-pr))/(2*(nr+z^2))
ci.low.r=(2*nr+z^2 - z*sqrt(z^2+4*nr*(1-pr)))/(2*(nr+z^2))
LI.dif.p=(pr-pc)-sqrt((pr-ci.lowr.)^2 + (ci.upp.c - pc)^2)
ci.low.r=(2*nr+z^2 - z*sqrt(z^2+4*nr*(1-pr)))/(2*(nr+z^2))
ci.upp.r=(2*nr+z^2 + z*sqrt(z^2+4*nr*(1-pr)))/(2*(nr+z^2))
ci.low.c=(2*nx+z^2 - z*sqrt(z^2+4*nx*(1-pc)))/(2*(nx+z^2))
ci.upp.c=(2*nx+z^2 + z*sqrt(z^2+4*nx*(1-pc)))/(2*(nx+z^2))
LI.dif.p=(pr-pc)-sqrt((pr-ci.lowr.)^2 + (ci.upp.c - pc)^2)
LI.dif.p=(pr-pc)-sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
r=xr/nr
pc=xc/nx
ci.low.r=(2*xr+z^2 - z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.upp.r=(2*xr+z^2 + z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.low.c=(2*xc+z^2 - z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
ci.upp.c=(2*xx+z^2 + z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
LI.dif.p=(pr-pc)-sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
pr=xr/nr
pc=xc/nx
ci.low.r=(2*xr+z^2 - z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.upp.r=(2*xr+z^2 + z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.low.c=(2*xc+z^2 - z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
ci.upp.c=(2*xx+z^2 + z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
LI.dif.p=(pr-pc)-sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
(pr-pc)
ci.low.r=(2*xr+z^2 - z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
pr=xr/nr
pc=xc/nx
ci.low.r=(2*xr+z^2 - z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.upp.r=(2*xr+z^2 + z*sqrt(z^2+4*xr*(1-pr)))/(2*(nr+z^2))
ci.low.c=(2*xc+z^2 - z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
ci.upp.c=(2*xc+z^2 + z*sqrt(z^2+4*xc*(1-pc)))/(2*(nx+z^2))
LI.dif.p=(pr-pc)-sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
LI.dif.p=(pr-pc)-sqrt((pr-ci.low.r)^2 + (ci.upp.c - pc)^2)
LS.dif.p=(pr-pc)+sqrt((pc-ci.low.c)^2 + (ci.upp.r - pr)^2)
#Wilson
LIpW=1/(1+z^2/n)*(p+z^2/(2*n))-z/(1+z^2/n)*sqrt(p*(1-p)/n+z^2/(4*n^2))
LSpW=1/(1+z^2/n)*(p+z^2/(2*n))+z/(1+z^2/n)*sqrt(p*(1-p)/n+z^2/(4*n^2))
LIpWC=1/(1+z^2/nx)*(pc+z^2/(2*nx))-z/(1+z^2/nx)*sqrt(pc*(1-pc)/nx+z^2/(4*nx^2))
LSpWC=1/(1+z^2/nx)*(pc+z^2/(2*nx))+z/(1+z^2/nx)*sqrt(pc*(1-pc)/nx+z^2/(4*nx^2))
x=rpois(10, 4.5)
x
paste0(x,collapse = =";")
paste0(x,collapse =";")
paste0(x,collapse =", ")
sett.seed(54470)
t=10
lambda=4.5
x=rpois(t, lambda)
mx=mean(x)
couint(x)
count(x)
length(x)
library(DescTools)
PoissonCI(x, n=1, conf.level = 0.95, method = "exact")
count <- 0:4
deaths <- c(144, 91, 32, 11, 2)
n <- sum(deaths)
n
x <- sum(count * deaths)
x
count
lambda <- x/n
PoissonCI(x=x, n=n, method = c("exact","score", "wald", "byar"))
exp <- dpois(0:4, lambda) * n
barplot(rbind(deaths, exp * n/sum(exp)), names=0:4, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
legend("topright", legend=c("observed","expected"), fill=c(hred, hblue),
bg="white")
x <- sum(t*x)
lambda <- x/n
lambda
n <- sum(x)
x <- sum(t*x)
lambda <- x/n
o=sum(dias*x)
alfa=0.05
t=10
dias=0:10
lambda=4.5
x=rpois(t, lambda)
n=sum(x)
o=sum(dias*x)
lmbda=mean(x)
alfa=0.05
t=10
dias=1:10
lambda=4.5
x=rpois(t, lambda)
n=sum(x)
o=sum(dias*x)
lmbda=mean(x)
n=sum(x)
o=sum(dias*x)
lambda <- o/n
lmbda=mean(x)
set.seed(54470)
alfa=0.05
t=10
dias=1:10
lambda=4.5
x=rpois(t, lambda)
lmbda=mean(x)
set.seed(54470)
alfa=0.05
t=10
dias=1:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
n=sum(x)
o=sum(dias*x)
lambda <- o/n
dias=0:10
n=sum(x)
o=sum(dias*x)
lambda <- o/n
PoissonCI(x=o, n=n, method = c("exact","score", "wald", "byar"))
exp <- dpois(1:10, lambda) * n
barplot(rbind(x, exp * n/sum(exp)), names=0:4, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
barplot(rbind(x, exp * n/sum(exp)), names=0:10, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
set.seed(54470)
alfa=0.05
t=10
dias=0:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
#CI com R PoissonCI
library(DescTools)
PoissonCI(x, n=, conf.level = 0.95, method = "exact")
n=sum(x)
o=sum(dias*x)
lambda <- o/n
PoissonCI(x=o, n=n, method = c("exact","score", "wald", "byar"))
exp <- dpois(1:10, lambda) * n
barplot(rbind(x, exp * n/sum(exp)), names=0:10, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
legend("topright", legend=c("observed","expected"), fill=c(hred, hblue),
bg="white")
set.seed(54470)
alfa=0.05
t=10
dias=1:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
#CI com R PoissonCI
library(DescTools)
PoissonCI(x, n=, conf.level = 0.95, method = "exact")
n=sum(x)
o=sum(dias*x)
lambda <- o/n
PoissonCI(x=o, n=n, method = c("exact","score", "wald", "byar"))
exp <- dpois(1:10, lambda) * n
barplot(rbind(x, exp * n/sum(exp)), names=0:10, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
legend("topright", legend=c("observed","expected"), fill=c(hred, hblue),
bg="white")
set.seed(54470)
alfa=0.05
t=10
dias=1:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
#CI com R PoissonCI
library(DescTools)
PoissonCI(x, n=, conf.level = 0.95, method = "exact")
n=sum(x)
o=sum(dias*x)
lambda <- o/n
PoissonCI(x=o, n=n, method = c("exact","score", "wald", "byar"))
exp <- dpois(1:10, lambda) * n
barplot(rbind(x, exp * n/sum(exp)), names=1:10, beside=TRUE,
col=c(hred, hblue), main = "Deaths from Horse Kicks", xlab = "count")
legend("topright", legend=c("observed","expected"), fill=c(hred, hblue),
bg="white")
x=rpois(t, lambdap)
x
PoissonCI(x=x, n=lmbda, conf.level = 0.95, method = "exact")
PoissonCI(x=sum(x), n=lmbda, conf.level = 0.95, method = "exact")
PoissonCI(x=sum(x), n=lmbda, conf.level = 0.95, c("exact","score", "wald", "byar"))
PoissonCI(x=sum(x), n=lmbda, conf.level = 0.95, method=c("exact","score", "wald", "byar"))
PoissonCI(x=sum(dias*x), n=sum(x), conf.level = 0.95, method=c("exact","score", "wald", "byar"))
lmbda=mean(x)
poisson.test(x=sum(x),T=t)
PoissonCI(x=sum(x), n=t, conf.level = 0.95, method=c("exact","score", "wald", "byar"))
v1=2*t*lmbda
v2=2*(t*lmbda+1)
chi1=qchisq(alfa/2,v1)
chi1=qchisq(alfa/2,v1)|>round(3)
chi2=qchisq(1-alfa/2,v2)|>round(3)
Lex=0.5*chi1
Uex=0.5*chi2
LIex=Lex/t
LSex=Uex/t
z=qnorm(1-alfa/2)|>round(3)
LIw=lmbda+z^2/(2*t)- z/sqrt(t)*\sqrt(lmbda+z^2/(4*t))
z=qnorm(1-alfa/2)|>round(3)
LIw=lmbda+z^2/(2*t) - z/sqrt(t)*\sqrt(lmbda+z^2/(4*t))
LIw <- lmbda+z^2/(2*t) - z/sqrt(t)*sqrt(lmbda+z^2/(4*t))
LIw <- (lmbda+z^2/(2*t) - z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
LSw <- (lmbda+z^2/(2*t) + z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
set.seed(54470)
alfa=0.01
t=10
dias=1:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
#IC exacto
v1=2*t*lmbda
v2=2*(t*lmbda+1)
chi1=qchisq(alfa/2,v1)|>round(3)
chi2=qchisq(1-alfa/2,v2)|>round(3)
Lex=(0.5*chi1)|>round(3)
Uex=(0.5*chi2)|>round(3)
LIex=(Lex/t)|>round(3)
LSex=(Uex/t)|>round(3)
# IC Wilson
z <- qnorm(1-alfa/2)|>round(3)
LIw <- (lmbda+z^2/(2*t) - z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
LSw <- (lmbda+z^2/(2*t) + z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
#CI com R PoissonCI
library(DescTools)
PoissonCI(x=sum(x), n=t, conf.level = 1-alfa, method=c("exact","score", "wald", "byar"))
medx=median(x)
sort(x)[3]
LImed <- t*0.5-z*sqrt(t*0.5*(1-t*0.5))
set.seed(54470)
alfa=0.01
t=10
dias=1:10
lambdap=4.5
x=rpois(t, lambdap)
lmbda=mean(x)
medx=median(x)
#IC exacto
v1=2*t*lmbda
v2=2*(t*lmbda+1)
chi1=qchisq(alfa/2,v1)|>round(3)
chi2=qchisq(1-alfa/2,v2)|>round(3)
Lex=(0.5*chi1)|>round(3)
Uex=(0.5*chi2)|>round(3)
LIex=(Lex/t)|>round(3)
LSex=(Uex/t)|>round(3)
# IC Wilson
z <- qnorm(1-alfa/2)|>round(3)
LIw <- (lmbda+z^2/(2*t) - z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
LSw <- (lmbda+z^2/(2*t) + z/sqrt(t)*sqrt(lmbda+z^2/(4*t)))|>round(3)
#CI com R PoissonCI
library(DescTools)
PoissonCI(x=sum(x), n=t, conf.level = 1-alfa, method=c("exact","score", "wald", "byar"))
#CI median
LImed <- t*0.5-z*sqrt(t*0.5*(1-t*0.5))
rLImed <- t*0.5-z*sqrt(t*0.5*(1-t*0.5))
rLSmed <- t*0.5+z*sqrt(t*0.5*(1-t*0.5))
alfa=0.01
t=10
z <- qnorm(1-alfa/2)|>round(3)
rLImed <- t*0.5-z*sqrt(t*0.5*(1-t*0.5))
t
t*0.5
z
rLImed <- t*0.5-z*sqrt(t*0.5*(1-0.5))
rLSmed <- t*0.5+z*sqrt(t*0.5*(1-0.5))
?wilcox.test.
?wilcox.test
?MedianCI
# for Maroquices
options(jamovi_home="C:\\Program Files\\jamovi 2.3.18.0")
library(jmvtools)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd('Maroquices')
jmvtools::install()
round(3.5,0)
round(3.2,0)
